import Head from "next/head";
import Image from "next/image";

import { Inter } from "next/font/google";

import { Box, Typography, Button, Stack} from "@mui/material";
import CssBaseline from '@mui/material/CssBaseline';
import { useCharlaContext } from "@/Contexts/UserContext";
import { useEffect, useState } from "react";
import { LayoutStack, SubheadingText } from "@/Components/StyledComponents";

const inter = Inter({ subsets: ["latin"] });

export default function Home() {
  const { mobile } = useCharlaContext();

  const langs = ['en' ,'es', 'fr', 'it', 'de']
  const [currentLang, setCurrentLang] = useState(langs[0]);
  const [visible, setVisible] = useState(false);

  const handleNextLang = () => {
    const currentIndex = langs.indexOf(currentLang);
    const nextIndex = (currentIndex + 1) % langs.length; 
    setCurrentLang(langs[nextIndex]);
    setVisible(false);

    setTimeout(() => {
      setCurrentLang(langs[nextIndex]);
      setVisible(true);
    }, 500);
  };

  useEffect(() => {
    const interval = setInterval(handleNextLang, 5000); 

    return () => clearInterval(interval);
  }, [currentLang]);

  const languageTranslations = [{en: 'Introducing', es: 'Presentando', fr: 'Présentation', it : 'Presentazione', de: 'Präsentation'}];
  
  return (
    <>
      <CssBaseline />
      <Head>
        <title>Charla</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet"/>
      </Head>
      <main className={`${inter.className}`}>
        <LayoutStack sx={{minHeight: "70vh", padding : '0 1rem 0 1rem' }} mobile = {mobile}>
          <Box
            sx={{
              flexGrow: 1,
              margin: "2rem",
              maxWidth: mobile ? "100%" : "50%",
            }}
          >
            <Box className = 'lang-pagination-container flex-items-center'>
              {langs.map((lang, i) => {
                return (<Typography key = {`pagination-lang-${i}`} variant = 'h5' sx={{ opacity: lang === currentLang ? 1 : 0.5, transitionDuration : '1s' }}>
                  {lang}
                </Typography>)
              })}
            </Box>
            <Typography
              variant={mobile ? "h4" : "h3"}
              sx={{ margin: "1rem 0", textAlign: "left" }}
              className={`fade-up ${visible  ? 'visible' : ''}`}
            >
              {languageTranslations[0][currentLang]}
            </Typography>
            <Typography
              variant={'h1'}  
              sx={{ margin: "1rem 0", textAlign: "left" }}
              className = 'logo-colors text-bold'
            >
              Charla
            </Typography>
            <Stack direction="row" justifyContent="center" alignItems="center">
              <SubheadingText
                variant={mobile ? "h6" : "h4"}
                mobile = {mobile}
                sx={{ margin: "1rem 0", textAlign: "left" }}
              >
                Converse your way to fluency. Charla, your AI language partner,
                makes learning natural.
              </SubheadingText>
              {mobile && (
                <Image
                  src="/charla-icon-light.svg"
                  alt="Charla icon"
                  height={150}
                  width={150}
                />
              )}
            </Stack>
            <Button
              href="/sign-up"
              variant="contained"
              className = 'get-started-button'
              sx = {{width : mobile ? '100%' : '30%'}}
            >
              <Typography
                variant={mobile ? "h6" : "h4"}
              >
                Get started
              </Typography>
            </Button>
          </Box>
          {!mobile && (
            <Box
              sx={{
                marginTop: "2rem",
                maxWidth: "50%",
                position: "relative"
              }}
            >
                <Image
                  src="/charla-icon-light.svg"
                  alt="Charla icon"
                  height={500}
                  width={500}
                />
            </Box>
          )}
        </LayoutStack>
        <Box sx = {{minHeight: "20vh", padding : '0 1rem 0 1rem' }}>
          <SubheadingText variant="h4" sx = {{margin: "0 2rem 1rem 2rem"}} mobile = {mobile}>
            Take your first steps to practicing in a language of your choice. Get automatic <span className="description-error-text">correccions</span>  and suggestions for how to improve your sentences. <span className="description-saved-text">Save</span>  phrases for later in a personalized dictionary.
          </SubheadingText>
        </Box>
      </main>
    </>
  );
}
